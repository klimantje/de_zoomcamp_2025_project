{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-31T22:23:38.038866Z", "invocation_id": "8feff419-d7a1-473e-bc45-3f517038fdd7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.796274Z", "completed_at": "2025-03-31T22:23:37.805097Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.805697Z", "completed_at": "2025-03-31T22:23:37.805703Z"}], "thread_id": "Thread-2", "execution_time": 0.08198285102844238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bike_rentals.stg_tfl_locations", "compiled": true, "compiled_code": "with source as (\n        select * from `dezoomcamp2025-454617`.`bike_rentals`.`raw_locations`\n  ),\n  renamed as (\n      select\n        `id` as bike_point_id,\n        `name` as location_name,\n        `terminalName` as location_id,\n        CAST( `long` AS FLOAT64) as longitude,\n        CAST( `lat` AS FLOAT64) as lattitude,\n        ST_GEOGPOINT(CAST( `long` AS FLOAT64) , CAST( `lat` AS FLOAT64)) as geo_location,\n        CAST( `installed` AS BOOL) as is_installed,\n        `locked` as is_locked,\n       TIMESTAMP_MILLIS(CAST(`installDate` AS INT)) as installed_at,\n       TIMESTAMP_MILLIS(CAST(`removalDate` AS INT )) as removed_at,\n        `temporary` as is_temporary,\n        `nbBikes` as number_of_bikes ,\n        `nbStandardBikes` as number_of_standard_bikes,\n        `nbEBikes` as number_of_ebikes,\n        `nbEmptyDocks` as number_of_empty_docks,\n        `nbDocks` as number_of_docks,\n       TIMESTAMP_MILLIS(  CAST(`last_updated` AS INT)) as last_updated_at\n\n      from source\n  )\n  select * from renamed", "relation_name": "`dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_locations`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.785970Z", "completed_at": "2025-03-31T22:23:37.804736Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.805390Z", "completed_at": "2025-03-31T22:23:37.805398Z"}], "thread_id": "Thread-1", "execution_time": 0.08307409286499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bike_rentals.stg_tfl_journeys", "compiled": true, "compiled_code": "\n\n\nwith source as (\n        select * from `dezoomcamp2025-454617`.`bike_rentals`.`raw_journeys`\n  ),\n  renamed as (\n  select\n      rental_id,\n      bike_id,\n      COALESCE(bike_model, 'UNKNOWN') as bike_model,\n      start_station_id,\n      start_station,\n      end_station_id,\n      end_station, \n      start_date,\n      end_date,\n      \n    CASE\n        WHEN REGEXP_CONTAINS(start_date, r\"\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y-%m-%d %H:%M:%S\", start_date)\n        WHEN REGEXP_CONTAINS(start_date, r\"\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y-%m-%d %H:%M\", start_date)\n        WHEN REGEXP_CONTAINS(start_date, r\"\\d{2}/\\d{2}/\\d{4} \\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%d/%m/%Y %H:%M\", start_date)\n        WHEN REGEXP_CONTAINS(start_date, r\"\\d{4}/\\d{2}/\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y/%m/%d\", start_date)\n        ELSE NULL\n    END\n as ride_started,\n      \n    CASE\n        WHEN REGEXP_CONTAINS(end_date, r\"\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y-%m-%d %H:%M:%S\", end_date)\n        WHEN REGEXP_CONTAINS(end_date, r\"\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y-%m-%d %H:%M\", end_date)\n        WHEN REGEXP_CONTAINS(end_date, r\"\\d{2}/\\d{2}/\\d{4} \\d{2}:\\d{2}\") THEN PARSE_TIMESTAMP(\"%d/%m/%Y %H:%M\", end_date)\n        WHEN REGEXP_CONTAINS(end_date, r\"\\d{4}/\\d{2}/\\d{2}\") THEN PARSE_TIMESTAMP(\"%Y/%m/%d\", end_date)\n        ELSE NULL\n    END\n as ride_ended,\n      CAST(CAST(total_duration_ms AS INT)/60000 AS INT) as trip_duration_mins\n  from source \n  )\nselect * from renamed\n   \n\n    -- recalculate latest day's data + previous\n    -- NOTE: The _dbt_max_partition variable is used to introspect the destination table\n    where date(ride_started) >= date_sub(date(_dbt_max_partition), interval 1 month)\n    ", "relation_name": "`dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.870654Z", "completed_at": "2025-03-31T22:23:37.890571Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.890852Z", "completed_at": "2025-03-31T22:23:37.890860Z"}], "thread_id": "Thread-4", "execution_time": 0.0840141773223877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.not_null_stg_tfl_locations__geo_location_.31e1ccfc33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect `geo_location`\nfrom `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_locations`\nwhere `geo_location` is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.879619Z", "completed_at": "2025-03-31T22:23:37.891611Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.891873Z", "completed_at": "2025-03-31T22:23:37.891878Z"}], "thread_id": "Thread-2", "execution_time": 0.08399224281311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bike_rentals.int_journeys_joined", "compiled": true, "compiled_code": "\n\n\n\n\nwith journeys as (\n  select * from `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys` \n  ),\nlocations as (select * from `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_locations`),\njourneys_start as\n(select \njourneys.rental_id, \njourneys.bike_id, \njourneys.bike_model, \njourneys.ride_started, \njourneys.ride_ended, \njourneys.trip_duration_mins,\njourneys.end_station_id,\njourneys.end_station,\nCOALESCE(locations.location_id, journeys.start_station_id) as start_station_id, \nCOALESCE(locations.location_name, journeys.start_station) as start_station,\nlocations.bike_point_id as start_bike_point_id, \nlocations.geo_location as start_geo_location,\nlocations.longitude as start_longitude,\nlocations.lattitude as start_lattitude\n\nfrom \njourneys left join locations\non (journeys.start_station_id = locations.location_id\nor journeys.start_station_id = locations.bike_point_id\nor LPAD(journeys.start_station_id, 6, '0') = locations.location_id)\nOR journeys.start_station = locations.location_name),\njourneys_complete as (\nselect \njourneys_start.rental_id, \njourneys_start.bike_id, \njourneys_start.bike_model, \njourneys_start.ride_started, \njourneys_start.ride_ended,  \njourneys_start.trip_duration_mins,\njourneys_start.start_station_id,\njourneys_start.start_station,\njourneys_start.start_bike_point_id,\njourneys_start.start_geo_location,\njourneys_start.start_longitude,\njourneys_start.start_lattitude,\nCOALESCE(locations.location_id, journeys_start.end_station_id) as end_station_id, \nCOALESCE(locations.location_name, journeys_start.end_station) as end_station,\nlocations.bike_point_id as end_bike_point_id, \nlocations.geo_location as end_geo_location,\nlocations.longitude as end_longitude,\nlocations.lattitude as end_lattitude\nfrom journeys_start\nleft join locations\non (journeys_start.end_station_id = locations.location_id\nor journeys_start.end_station_id = locations.bike_point_id\nor LPAD(journeys_start.end_station_id, 6, '0') = locations.location_id\nor journeys_start.end_station = locations.location_name)\n)\nselect \nrental_id,\nbike_id,\nbike_model,\nride_started,\nride_ended,\ntrip_duration_mins,\nstart_station_id,\nstart_station,\nstart_bike_point_id,\nstart_geo_location,\nend_station_id,\nend_station,\nend_bike_point_id,\nend_geo_location,\nROUND(ST_DISTANCE(start_geo_location, end_geo_location) ) as trip_distance_in_meters\nfrom journeys_complete\n\n\n-- recalculate latest day's data + previous\n-- NOTE: The _dbt_max_partition variable is used to introspect the destination table\nwhere date(ride_started) >= date_sub(date(_dbt_max_partition), interval 1 month)\n", "relation_name": "`dezoomcamp2025-454617`.`bike_rentals`.`int_journeys_joined`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.882514Z", "completed_at": "2025-03-31T22:23:37.892313Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.892892Z", "completed_at": "2025-03-31T22:23:37.892896Z"}], "thread_id": "Thread-1", "execution_time": 0.07849812507629395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.accepted_values_stg_tfl_journeys_bike_model__CLASSIC__PBSC_EBIKE__UNKNOWN.57fc7dd81b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        bike_model as value_field,\n        count(*) as n_records\n\n    from `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`\n    group by bike_model\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CLASSIC','PBSC_EBIKE','UNKNOWN'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.888186Z", "completed_at": "2025-03-31T22:23:37.892100Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.892582Z", "completed_at": "2025-03-31T22:23:37.892586Z"}], "thread_id": "Thread-3", "execution_time": 0.07731294631958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.not_null_stg_tfl_journeys_rental_id.1ac8141422", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rental_id\nfrom `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`\nwhere rental_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.956523Z", "completed_at": "2025-03-31T22:23:37.961897Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.971638Z", "completed_at": "2025-03-31T22:23:37.971644Z"}], "thread_id": "Thread-4", "execution_time": 0.07979702949523926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.not_null_stg_tfl_journeys_ride_ended.d4d1253096", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ride_ended\nfrom `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`\nwhere ride_ended is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.961291Z", "completed_at": "2025-03-31T22:23:37.973658Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.974354Z", "completed_at": "2025-03-31T22:23:37.974357Z"}], "thread_id": "Thread-2", "execution_time": 0.07603693008422852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.not_null_stg_tfl_journeys_ride_started.43d4dc30eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ride_started\nfrom `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`\nwhere ride_started is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.962112Z", "completed_at": "2025-03-31T22:23:37.973427Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.974119Z", "completed_at": "2025-03-31T22:23:37.974123Z"}], "thread_id": "Thread-1", "execution_time": 0.07637405395507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bike_rentals.unique_stg_tfl_journeys_rental_id.2fd02c46d6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select rental_id as unique_field\n  from `dezoomcamp2025-454617`.`bike_rentals`.`stg_tfl_journeys`\n  where rental_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T22:23:37.965711Z", "completed_at": "2025-03-31T22:23:37.973157Z"}, {"name": "execute", "started_at": "2025-03-31T22:23:37.973886Z", "completed_at": "2025-03-31T22:23:37.973892Z"}], "thread_id": "Thread-3", "execution_time": 0.07663607597351074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bike_rentals.journey_stats", "compiled": true, "compiled_code": "with journeys as (\n    select * from `dezoomcamp2025-454617`.`bike_rentals`.`int_journeys_joined`\n)\n\nselect \nstart_station_id,\nstart_station,\nend_station_id,\nend_station,\nbike_model,\ntimestamp_trunc(\n        cast(ride_started as timestamp),\n        month\n    ) as ride_month, \navg(trip_distance_in_meters) as average_trip_distance,\navg(trip_duration_mins) as average_trip_duration,\ncount(rental_id) as total_monthly_trips,\nfrom journeys\ngroup by 1,2,3,4,5,6", "relation_name": "`dezoomcamp2025-454617`.`bike_rentals`.`journey_stats`", "batch_results": null}], "elapsed_time": 0.7574338912963867, "args": {"state_modified_compare_vars": false, "version_check": true, "profiles_dir": "/Users/ai49st/Developer/de_zoomcamp_2025_project/bike_rentals", "vars": {}, "print": true, "macro_debugging": false, "defer": false, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "empty_catalog": false, "cache_selected_only": false, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "log_format_file": "debug", "indirect_selection": "eager", "project_dir": "/Users/ai49st/Developer/de_zoomcamp_2025_project/bike_rentals", "log_level_file": "debug", "partial_parse": true, "printer_width": 80, "quiet": false, "introspect": true, "log_level": "info", "favor_state": false, "send_anonymous_usage_stats": true, "exclude": [], "log_file_max_bytes": 10485760, "select": [], "show_resource_report": false, "static_parser": true, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_more_unrendered_values": false, "compile": true, "source_freshness_run_project_hooks": false, "strict_mode": false, "static": false, "log_format": "default", "write_json": true, "log_path": "/Users/ai49st/Developer/de_zoomcamp_2025_project/bike_rentals/logs", "which": "generate", "invocation_command": "dbt docs generate"}}